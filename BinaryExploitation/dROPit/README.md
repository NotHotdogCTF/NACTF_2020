As the name implies this will be a ROP challenge.

Looking at the disassembly we can see that we can overflow the fgets buffer with 0x30 bytes.

Using this we can figure out the version of libc by print the address of known libc functions (fgets, puts, and setvbuf) by calling puts to output the address.

To do this we will need a single pop rop gadet.  using ROPgadget we find a 'pop rdi; ret' gadget which is exactly what we need.

So now, we can print the address of our known libc functions by poping rdi, adding the address we want to read, then adding puts address.

Once we have this information we can use that version of libc to calculate the location of system and call '/bin/sh\x00' which will pop a shell.

From here we can run 'cat flag.txt' to get the flag.

nactf{r0p_y0ur_w4y_t0_v1ct0ry_698jB84iO4OH1cUe}
